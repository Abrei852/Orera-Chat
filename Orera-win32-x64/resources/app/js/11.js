(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{"32fd":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{staticClass:"full-width"},[e.error?n("q-banner",{staticClass:"bg-red-1 text-center text-red text-bold fixed-top"},[e._v(e._s(e.error))]):e._e(),n("video",{ref:"localVideo",staticClass:"localUser",attrs:{autoplay:"",playsinline:""}}),n("div",{staticClass:"button row justify-center"},[e.hangupButton?e._e():n("q-btn",{attrs:{round:"",color:"secondary",icon:"videocam"},on:{click:e.makeCall}}),e.hangupButton?n("q-btn",{attrs:{round:"",color:"primary",icon:"videocam_off"},on:{click:e.turnOffRemoteVideo}}):e._e()],1),n("div",{attrs:{color:"transparent"},on:{click:e.confirm}}),n("video",{ref:"remoteVideo",staticClass:"remoteUser",attrs:{autoplay:"",playsinline:""}})],1)},o=[],a=(n("46d4"),n("dddc"),n("63b8"),n("a13d")),i={iceServers:[{urls:"stun:stun.services.mozilla.com"},{urls:"turn:numb.viagenie.ca",credential:"".concat("Qwerty12345"),username:"".concat("abraham.eishow.syne19lin@tucsweden.se")},{urls:"turn:192.158.29.39:3478?transport=udp",credential:"JZEOEt2V3Qb0y27GRntt2u2PAYA=",username:"28224511:1379330808"}]},s=new RTCPeerConnection(i),c=Math.floor(1e9*Math.random()),u={data:function(){return{error:"",hangupButton:!1}},methods:{sendMessage:function(e,t){var n=a["c"].ref("videos").push({sender:e,message:t});n.remove()},readMessage:function(e){var t=this,n=JSON.parse(e.val().message),r=e.val().sender;r!=c&&(void 0!=n.ice?s.addIceCandidate(new RTCIceCandidate(n.ice)):"offer"==n.sdp.type?s.setRemoteDescription(new RTCSessionDescription(n.sdp)).then((function(){return s.createAnswer()})).then((function(e){return s.setLocalDescription(e)})).then((function(){return t.sendMessage(c,JSON.stringify({sdp:s.localDescription}))})).catch((function(e){return t.error="A connection could not be established!"})):"answer"==n.sdp.type&&s.setRemoteDescription(new RTCSessionDescription(n.sdp)))},startCamera:function(){var e=this,t={video:{width:{ideal:4096},height:{ideal:2160},facingMode:"user"},audio:{sampleSize:16,volume:.2,channelCount:{ideal:2},autoGainControl:!1,echoCancellation:!0,noiseSuppression:!0}};navigator.mediaDevices.getUserMedia(t).then((function(t){return e.$refs.localVideo.srcObject=t})).then((function(e){return s.addStream(e)})).catch((function(t){return e.error="Something went wrong, please refresh the page!"}))},makeCall:function(){var e=this;s.createOffer().then((function(e){return s.setLocalDescription(e)})).then((function(){return e.sendMessage(c,JSON.stringify({sdp:s.localDescription}))})).catch((function(t){return e.error="Something went wrong, please refresh and call again!"})),this.hangupButton=!0},turnOffRemoteVideo:function(){try{var e=this.$refs.remoteVideo.srcObject;e.getVideoTracks().forEach((function(e){e.stop()})),s.close(),this.hangupButton=!1}catch(t){return this.error="Something went wrong, please refresh and call again!"}},disableCamera:function(){var e=this.$refs.localVideo.srcObject;e.getVideoTracks().forEach((function(e){e.stop()})),e.getAudioTracks().forEach((function(e){e.stop()}))},confirm:function(){var e=this;this.$q.dialog({title:"Confirm",message:"Would you like to receive the call?",cancel:!0,persistent:!0}).onCancel((function(){e.turnOffRemoteVideo()}))}},beforeMount:function(){a["c"].ref("videos").on("child_added",this.readMessage)},mounted:function(){var e=this;this.startCamera(),s.onicecandidate=function(t){return t.candidate?e.sendMessage(c,JSON.stringify({ice:t.candidate})):console.log("Success")},s.ontrack=function(t){var n=t.track,r=t.streams;n.onunmute=function(){e.$refs.remoteVideo.srcObject||(e.confirm(),e.$refs.remoteVideo.srcObject=r[0],e.hangupButton=!0)}}},beforeDestroy:function(){this.disableCamera(),this.turnOffRemoteVideo()}},d=u,l=(n("8433"),n("a6c2")),f=n("505d"),h=n("91e4"),p=n("ef9c"),m=n("63c1"),g=n.n(m),v=Object(l["a"])(d,r,o,!1,null,"70354161",null);t["default"]=v.exports;g()(v,"components",{QPage:f["a"],QBanner:h["a"],QBtn:p["a"]})},"65a0":function(e,t,n){},8433:function(e,t,n){"use strict";n("65a0")}}]);